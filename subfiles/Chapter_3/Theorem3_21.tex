\documentclass[../../main.tex]{subfiles}

\begin{document}
\providecommand{\local}{{L^{1}_{loc}}}
\providecommand{\lf}{{\mathcal{L}_f}}
\problem{3.21}
\begin{wts}
The Lebesgue Differentiation Theorem. Suppose $f\in\local$, and for every $x\in \lf$, (so that $x\in\realn$ a.e). We have
\begin{enumerate}
    \item $\lim_{r\to 0}\dfrac{1}{m(E_r)}\int_{E_r}|f(y)-f(x)|dy = 0$,
    \item $\lim_{r\to 0}\dfrac{1}{m(E_r)}\int_{E_r}f(y)dy = f(x)$,
\end{enumerate}
For every family $\{E_r\}_{r>0}$ that shrinks nicely to $x\in\realn'$.

\end{wts}
\begin{proof}
    Since the family $\{E_r\}_{r>0}$ shrinks nicely, we have
    \[m(E_r)\gtrsim m(B(r,x))\implies m(E_r)> \alpha\cdot m(B(r,x))\]
    for some $\alpha>0$, independent on $r$. Rearranging gives
    \[m^{-1}(E_r)<\alpha^{-1}m^{-1}(B(r,x))\]
    And monotonicity of the integral 
    \[
    \int_{E_r} |f(y)-f(x)|dy\leq \int_{B(r,x)} |f(y)-f(x)|dy
    \]
    Combining the last two results, for every $\varepsilon>0$, if $0<r<\varepsilon$, then
    \[m^{-1}(E_r)\int_{E_r} |f(y)-f(x)|dy \leq m^{-1}B(r,x)\int_{B(r,x)} |f(y)-f(x)|dy\]
    Taking the supremum on both sides,
    \[\sup_{0<r<\varepsilon} m^{-1}(E_r)\int_{E_r} |f(y)-f(x)|dy \leq \sup_{0<r<\varepsilon}  m^{-1}B(r,x)\int_{B(r,x)} |f(y)-f(x)|dy\]
    and sending $\varepsilon\to 0$, proves the first claim. The second claim is immediate upon applying the $L^1$ inequality.\\

    Fix any $\varepsilon>0$, and 
    \begin{align*}
        \lim_{r\to 0}m^{-1}(E_r)\int_{E_r}f(y)dy = f(x)&\iff \lim_{\varepsilon\to 0}\sup_{0<r<\varepsilon} \left| m^{-1}(E_r)\int_{E_r}f(y)dy - f(x)\right|\\
        &\iff \lim_{\varepsilon\to 0}\sup_{0<r<\varepsilon} \left| m^{-1}(E_r)\int_{E_r}[f(y) - f(x)]dy\right|\\
        &\leq \lim_{\varepsilon\to 0}\sup_{0<r<\varepsilon} m^{-1}(E_r)\int_{E_r}|f(y) - f(x)|dy\\
        &=\lim_{r\to 0}m^{-1}(E_r)\int_{E_r}|f(y) - f(x)|dy\\
        &=0
    \end{align*}
\end{proof}

\end{document}